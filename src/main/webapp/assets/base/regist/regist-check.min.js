/**
 * 注册验证页。
 * 
 * @since 2018-01-27
 * @version 1.0
 * @author Luowen
 */


/**
 * 页面基本逻辑管理。
 * 
 * @return {void}
 */
((function pageManage() {
	var oVueOption = {
		el: "#pbody",
		data: {
			username: "",
			code: "",
		},
		mounted() {
			var _this = this,
				oParams = util.getParams()
			;
			
			_this.username = oParams.username || "";
			_this.code = oParams.code || ""

			if (_this.username && _this.code) {
				_this.check();
			}
		},
		methods: {
			check: function() {
				var _this = this;

				axios.post(TOP_DOMAIN + "api/base/user/checkRegistCode", {
					token: TOKEN,
					username: _this.username.trim(),
					code: _this.code.trim()
				}).then(function(oAjax) {
					var oAjaxData = oAjax.data;

					if (oAjaxData.c == 1) {
						_this.$Message.success({
							content: "验证成功",
							onClose() {
								location.href = "login.html";
							}
						});
					} else {
						_this.$Message.error("验证失败");
					}
				});
			}
		}
	};
	
	
	var vVue = new Vue(oVueOption);
	oVueOption = null;
}))();